(()=>{var e={9381:(e,t,a)=>{"use strict";var s=a(9911);class i{destructor(){null!==this.animationFrameId&&(window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.faceLandmarker&&(this.faceLandmarker.close(),this.faceLandmarker=void 0),this.canvas&&(this.canvas.width=0,this.canvas.height=0,this.canvas=null,this.ctx=null),this.results=void 0,this.lastVideoTime=0}setModelPath(e){this.modelPath=e}async makeDectector(){let e=await s.Ps.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/wasm"),t="".concat(self.location.origin).concat(this.modelPath);this.faceLandmarker=await s.pR.createFromOptions(e,{baseOptions:{modelAssetPath:t,delegate:"GPU"},outputFaceBlendshapes:!0,runningMode:"VIDEO",numFaces:1})}async predictWebcam(e,t){return(this.lastVideoTime!==t&&(this.lastVideoTime=t,this.faceLandmarker?(this.initCanvas(e.width,e.height),this.ctx&&this.canvas&&(this.ctx.putImageData(e,0,0),this.results=this.faceLandmarker.detectForVideo(this.canvas,t))):console.warn("FaceLandmarker가 초기화되지 않았습니다.")),this.results)?this.handleDetectionResults(this.results):-1}handleDetectionResults(e){let t=[];e.faceBlendshapes&&e.faceBlendshapes.length>0&&(t=e.faceBlendshapes[0].categories);let a=t.find(e=>"eyeBlinkLeft"===e.categoryName),s=t.find(e=>"eyeBlinkRight"===e.categoryName);if(!a||!s)return console.warn("눈 깜빡임 데이터를 찾을 수 없습니다:",t),-1;let i=a.score;return(i+s.score)/2}initCanvas(e,t){this.canvas&&this.canvas.width===e&&this.canvas.height===t||(this.canvas=new OffscreenCanvas(e,t),this.ctx=this.canvas.getContext("2d"))}constructor(){this.animationFrameId=null,this.modelPath="/face_landmarker.task",this.canvas=null,this.ctx=null,this.lastVideoTime=0,this.results=void 0}}let r=new i;onmessage=async e=>{let t=null,{type:a,data:s}=e.data;try{switch(a){case"initialize":s&&s.modelPath&&r.setModelPath(s.modelPath),await r.makeDectector(),t=setInterval(()=>{postMessage({type:"requestVideoFrame"})},33);break;case"getEyeStatus":let e=await r.predictWebcam(s.videoData,s.timestamp);postMessage({type:"eyeStatus",data:{status:e}});break;case"cleanup":r.destructor(),t&&clearInterval(t),postMessage({type:"cleanup",success:!0});break;default:postMessage({type:"error",message:"알 수 없는 메시지 타입입니다."})}}catch(t){let e=t instanceof Error?t.message:"알 수 없는 오류가 발생했습니다.";console.error("워커 에러:",e),postMessage({type:"error",message:e})}}}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}},n=!0;try{e[s](r,r.exports,a),n=!1}finally{n&&delete t[s]}return r.exports}a.m=e,a.x=()=>{var e=a.O(void 0,[911],()=>a(9381));return a.O(e)},(()=>{var e=[];a.O=(t,s,i,r)=>{if(s){r=r||0;for(var n=e.length;n>0&&e[n-1][2]>r;n--)e[n]=e[n-1];e[n]=[s,i,r];return}for(var c=1/0,n=0;n<e.length;n++){for(var[s,i,r]=e[n],o=!0,l=0;l<s.length;l++)(!1&r||c>=r)&&Object.keys(a.O).every(e=>a.O[e](s[l]))?s.splice(l--,1):(o=!1,r<c&&(c=r));if(o){e.splice(n--,1);var h=i();void 0!==h&&(t=h)}}return t}})(),a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,s)=>(a.f[s](e,t),t),[])),a.u=e=>"static/chunks/"+e+".f0396a80fc7c3981.js",a.miniCssF=e=>{},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;a.tt=()=>(void 0===e&&(e={createScriptURL:e=>e},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(e=trustedTypes.createPolicy("nextjs#bundler",e))),e)})(),a.tu=e=>a.tt().createScriptURL(e),a.p="/_next/",(()=>{var e={381:1};a.f.i=(t,s)=>{e[t]||importScripts(a.tu(a.p+a.u(t)))};var t=self.webpackChunk_N_E=self.webpackChunk_N_E||[],s=t.push.bind(t);t.push=t=>{var[i,r,n]=t;for(var c in r)a.o(r,c)&&(a.m[c]=r[c]);for(n&&n(a);i.length;)e[i.pop()]=1;s(t)}})(),(()=>{var e=a.x;a.x=()=>a.e(911).then(e)})(),_N_E=a.x()})();