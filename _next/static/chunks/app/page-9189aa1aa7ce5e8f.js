(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{309:(e,t,s)=>{Promise.resolve().then(s.bind(s,4484))},4484:(e,t,s)=>{"use strict";s.d(t,{default:()=>D});var n=s(2311),i=s(2847);function r(e){let{lastBlinkAt:t,isRunning:s}=e,[r,l]=(0,i.useState)(0);(0,i.useEffect)(()=>{if(t&&s){let e=setInterval(()=>{l(Number(((new Date().getTime()-t.getTime())/1e3).toFixed(2)))},100);return()=>clearInterval(e)}l(0)},[t,s]);let o=t?r.toFixed(1).padStart(6," "):"  --  ";return(0,n.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-3 border border-green-100",children:(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"마지막 깜빡임 간격"}),(0,n.jsxs)("p",{className:"text-xl font-bold text-green-700",style:{fontVariantNumeric:"tabular-nums",minWidth:"4.5em",display:"inline-block",textAlign:"left"},children:[o,"초"]})]})})})}let l=(0,i.memo)(function(e){let{isRunning:t}=e,s=(0,i.useMemo)(()=>t?"모니터링 중...":"대기 중",[t]),r=(0,i.useMemo)(()=>t?"bg-green-500 animate-pulse":"bg-gray-300",[t]);return(0,n.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,n.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(r)}),(0,n.jsx)("span",{className:"text-xs text-gray-600",children:s})]})}),o=(0,i.memo)(function(e){let{isRunning:t,onStart:s,onStop:r}=e,l=(0,i.useMemo)(()=>t?"모니터링 중지":"모니터링 시작",[t]),o=(0,i.useMemo)(()=>t?"⏹️":"▶️",[t]),a=(0,i.useMemo)(()=>t?"bg-red-500 hover:bg-red-600 text-white shadow-lg shadow-red-200":"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white shadow-lg shadow-blue-200",[t]);return(0,n.jsx)("button",{className:"w-full py-3 rounded-2xl font-semibold text-base transition-all duration-300 transform active:scale-95 ".concat(a),onClick:t?r:s,children:(0,n.jsxs)("span",{className:"flex items-center justify-center space-x-2",children:[(0,n.jsx)("span",{children:o}),(0,n.jsx)("span",{children:l})]})})}),a=(0,i.memo)(function(e){let{videoRef:t,isRunning:s}=e;return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("div",{className:"w-full h-40 object-cover rounded-2xl border-2 transition-all duration-300 flex items-center justify-center bg-gray-100 relative overflow-hidden select-none cursor-default ".concat(s?"border-blue-400 shadow-lg":"border-gray-200"),children:[s&&(0,n.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-br from-blue-700/60 to-indigo-500/60 z-10",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-2 animate-pulse",children:[(0,n.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD35"}),(0,n.jsx)("span",{className:"text-white text-lg font-bold drop-shadow",children:"카메라 ON"})]}),(0,n.jsx)("span",{className:"text-white text-xs opacity-80",children:"눈 깜빡임을 감지 중입니다"})]}),(0,n.jsx)("video",{ref:t,className:"w-full h-40 object-cover rounded-2xl",style:{opacity:0}})]}),!s&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-3xl mb-1",children:"\uD83D\uDCF9"}),(0,n.jsx)("p",{className:"text-gray-500 text-xs",children:"카메라를 시작해주세요"})]})})]})}),c=(0,i.memo)(function(e){let{isWarningEnabled:t,onToggleWarning:s}=e,r=(0,i.useMemo)(()=>t?"bg-orange-500":"bg-gray-300",[t]),l=(0,i.useMemo)(()=>t?"translate-x-6":"translate-x-1",[t]);return(0,n.jsx)("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 rounded-2xl p-3 border border-orange-100",children:(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-xs text-orange-600 font-medium",children:"소리 경고"}),(0,n.jsx)("button",{onClick:s,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat(r),children:(0,n.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(l)})})]})})})}),d=(0,i.memo)(function(e){let{warningThreshold:t,onUpdateThreshold:s}=e;return(0,n.jsxs)("div",{className:"flex items-center justify-between bg-gradient-to-r from-orange-50 to-amber-50 rounded-2xl p-3 border border-orange-100",children:[(0,n.jsx)("span",{className:"text-xs text-orange-600 font-medium",children:"경고 임계값"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("button",{onClick:()=>s(Math.max(1,t-1)),className:"w-6 h-6 rounded-full bg-orange-200 text-orange-600 text-xs font-bold hover:bg-orange-300",children:"-"}),(0,n.jsxs)("span",{className:"text-xs font-medium text-orange-700 min-w-[2rem] text-center",children:[t,"초"]}),(0,n.jsx)("button",{onClick:()=>s(t+1),className:"w-6 h-6 rounded-full bg-orange-200 text-orange-600 text-xs font-bold hover:bg-orange-300",children:"+"})]})]})}),h=(0,i.memo)(function(e){let{isWarningEnabled:t,onToggleWarning:s}=e,r=(0,i.useMemo)(()=>t?"bg-orange-500":"bg-gray-300",[t]),l=(0,i.useMemo)(()=>t?"translate-x-6":"translate-x-1",[t]);return(0,n.jsx)("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 rounded-2xl p-3 border border-orange-100",children:(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-xs text-orange-600 font-medium",children:"PIP 경고"}),(0,n.jsx)("button",{onClick:s,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat(r),children:(0,n.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(l)})})]})})})});var u=s(4782);function m(e){let{count:t,pipFlick:s}=e;return(0,n.jsxs)("div",{className:"w-[320px] h-[200px] rounded-2xl shadow-xl border border-gray-200 p-4 select-none ".concat(s?"bg-black":"bg-white"),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("div",{className:"text-sm text-gray-500",children:"Mini Control Panel"}),(0,n.jsxs)("div",{className:"relative group inline-block",children:[(0,n.jsx)("button",{"aria-label":"도움말",className:"w-6 h-6 rounded-full bg-gray-100 text-black text-xs grid place-items-center hover:bg-gray-200",children:"i"}),(0,n.jsx)("div",{className:"pointer-events-none absolute right-0 mt-2 w-56 rounded-md border border-gray-200 bg-white p-2 text-xs text-gray-600 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",children:"툴팁 예시: PiP 창 내에서도 hover/클릭 기반 툴팁이 정상 동작합니다."})]})]}),(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsx)("div",{className:"text-2xl font-semibold text-black tabular-nums",children:t})})]})}let p=(0,i.forwardRef)(function(e,t){let{isRunning:s,pipFlick:r}=e,l=(0,i.useRef)(null),o=(0,i.useRef)(null),[a,c]=(0,i.useState)(null),[d,h]=(0,i.useState)(0),p="documentPictureInPicture"in window,x=e=>{e&&Object.assign(e.style,{position:"fixed",top:"-10000px",left:"-10000px",width:"320px"})},v=e=>{Array.from(document.styleSheets).forEach(t=>{try{let s=Array.from(t.cssRules).map(e=>e.cssText).join(""),n=e.createElement("style");n.textContent=s,e.head.appendChild(n)}catch(s){if(t.href){let s=e.createElement("link");s.rel="stylesheet",s.href=t.href,e.head.appendChild(s)}}})},g=(0,i.useCallback)(async()=>{var e,t;if(!p)return;let s=window.documentPictureInPicture,n=null==(e=l.current)?void 0:e.getBoundingClientRect(),i=Math.max(260,Math.round((null==n?void 0:n.width)||320)),r=Math.max(160,Math.round((null==n?void 0:n.height)||200)),a=await (null==(t=s.requestWindow)?void 0:t.call(s,{width:i,height:r,disallowReturnToOpener:!0,preferInitialWindowPlacement:!0}));o.current=a,v(a.document),a.document.body.className="bg-white",a.document.body.style.margin="0",a.document.body.style.display="grid",a.document.body.style.placeItems="center",a.document.title="Mini Panel",c(a.document),a.addEventListener("pagehide",()=>{c(null),o.current=null},{once:!0})},[p]),w=(0,i.useCallback)(()=>{var e;null==(e=o.current)||e.close()},[]);return(0,i.useImperativeHandle)(t,()=>({open:g,close:w}),[g,w]),(0,i.useEffect)(()=>{let e=new BroadcastChannel("custom-pip");return e.onmessage=e=>{var t;(null==(t=e.data)?void 0:t.type)==="INC"&&h(e=>e+1)},()=>e.close()},[]),(0,i.useEffect)(()=>{"documentPictureInPicture"in window&&(s?g().catch(()=>{}):w())},[s,g,w]),(0,i.useEffect)(()=>(x(l.current),()=>w()),[w]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{ref:l,children:(0,n.jsx)(m,{count:d,pipFlick:r})}),a&&(0,u.createPortal)((0,n.jsx)(m,{count:d,pipFlick:r}),a.body)]})});class x{get(e){var t;return null!=(t=this.map.get(e))?t:null}set(e,t){return this.map.set(e,t),!0}delete(e){return this.map.delete(e)}constructor(){this.map=new Map}}class v{addTool(e,t){this.tools.set(e,t)}deleteTool(e){this.tools.delete(e)}getTools(){return Array.from(this.tools.keys())}setWarning(e,t){this.stopFuncs.forEach(e=>{e.stop()}),this.stopFuncs=[],this.tools.forEach(s=>{let n=s.execute(e,t);this.stopFuncs.push(n)})}endWarning(){this.stopFuncs.forEach(e=>{e.stop()}),this.stopFuncs=[]}constructor(){this.tools=new Map,this.stopFuncs=[]}}class g{startMonitoring(){this.status="ACTIVE",this.lastBlinkAt=new Date}recordEvent(e){if("ACTIVE"!==this.status)throw Error("not active");if(this.lastBlinkAt&&e<this.lastBlinkAt)throw Error("time back");this.lastBlinkAt=e}snapshot(){return{status:this.status,lastBlink:this.lastBlinkAt,threshold:this.threshold}}setThreshold(e){this.threshold=e}stopMonitoring(){this.status="ENDED"}constructor(e,t,s){this.status=e,this.lastBlinkAt=t,this.threshold=s}}let w={WarnFactory:Symbol("WarnFactory"),Blink:{Sensor:Symbol("Blink.Sensor"),DB:Symbol("Blink.DB"),Presenter:Symbol("Blink.Presenter"),Controller:Symbol("Blink.Controller"),Warn:Symbol("Blink.Warn"),WarnTools:Symbol("Blink.WarnTools")}};class f{async execute(e){var t;let s=null!=(t=this.db.get(e.type))?t:new g("ENDED",new Date,5);if(s.startMonitoring(),!this.db.set(e.type,s))return!1;if(this.sensor.canUse()){this.sensor.listen(e.type,this.eventCallback);let t=s.snapshot();return this.presenter.present(t),!0}return alert("카메라 사용 불가능합니다. \n[노트북, 데스크탑의 크롬, 엣지 추천]"),!1}constructor(e){this.resolve=e,this.eventCallback=e=>{var t;let s=null==(t=this.db.get("blink"))?void 0:t.snapshot();if(void 0==s||void 0==s.threshold)return;let n=s.threshold;this.warn.setWarning({threshold:n},this.presenter.present.bind(this.presenter)),this.presenter.present({lastBlinkAt:new Date})},this.sensor=this.resolve.get(w.Blink.Sensor),this.db=this.resolve.get(w.Blink.DB),this.presenter=this.resolve.get(w.Blink.Presenter),this.warn=this.resolve.get(w.Blink.Warn)}}class b{async execute(e){let t=this.db.get(e.type);if(void 0==t||(t.stopMonitoring(),!this.db.set(e.type,t)))return!1;this.sensor.off(e.type),this.warn.endWarning();let s=t.snapshot();return this.presenter.present(s),!0}constructor(e){this.resolve=e,this.sensor=this.resolve.get(w.Blink.Sensor),this.db=this.resolve.get(w.Blink.DB),this.presenter=this.resolve.get(w.Blink.Presenter),this.warn=this.resolve.get(w.Blink.Warn)}}class k{async execute(e){var t;let s=null==(t=this.db.get(e.type))?void 0:t.snapshot();if(void 0==s){let t=new g("ENDED",new Date,5);this.db.set(e.type,t),s=t.snapshot()}return e.warn.canUse()&&(this.warnTools.addTool(e.toolType,e.warn),s.warnTools=this.warnTools.getTools(),this.presenter.present(s)),!0}constructor(e){this.resolve=e,this.db=this.resolve.get(w.Blink.DB),this.presenter=this.resolve.get(w.Blink.Presenter),this.warnTools=this.resolve.get(w.Blink.Warn)}}class y{async execute(e){var t;let s=null!=(t=this.db.get(e.type))?t:new g("ENDED",new Date,5);if(s.setThreshold(e.threshold),!this.db.set(e.type,s))return!1;let n=s.snapshot();return"ACTIVE"===n.satus&&(this.sensor.listen(e.type,this.eventCallback),s.recordEvent(new Date)),n.warnTools=this.warnTools.getTools(),this.presenter.present(n),!0}constructor(e){this.resolve=e,this.eventCallback=e=>{var t;let s=null==(t=this.db.get("blink"))?void 0:t.snapshot();if(void 0==s||void 0==s.threshold)return;let n=s.threshold;this.warn.setWarning({threshold:n},this.presenter.present.bind(this.presenter)),this.presenter.present({lastBlinkAt:new Date})},this.sensor=this.resolve.get(w.Blink.Sensor),this.db=this.resolve.get(w.Blink.DB),this.presenter=this.resolve.get(w.Blink.Presenter),this.warn=this.resolve.get(w.Blink.Warn),this.warnTools=this.resolve.get(w.Blink.WarnTools)}}class T{async execute(e){var t;let s=null==(t=this.db.get(e.type))?void 0:t.snapshot();if(void 0==s){let t=new g("ENDED",new Date,5);this.db.set(e.type,t),s=t.snapshot()}return this.warnTools.deleteTool(e.toolType),s.warnTools=this.warnTools.getTools(),this.presenter.present(s),!0}constructor(e){this.resolve=e,this.db=this.resolve.get(w.Blink.DB),this.presenter=this.resolve.get(w.Blink.Presenter),this.warnTools=this.resolve.get(w.Blink.Warn)}}class j{canUse(){return"documentPictureInPicture"in window||(alert("PIP를 지원하지 않는 브라우저입니다.\n[크롬, 엣지 추천]"),!1)}execute(e,t){let s="number"==typeof e.threshold&&e.threshold<1e3?1e3*e.threshold:e.threshold,n=null,i=setTimeout(()=>{this.flick=!this.flick,t({pipFlick:this.flick}),n=setInterval(()=>{"function"==typeof t&&(this.flick=!this.flick,t({pipFlick:this.flick}))},800)},s);return{stop:()=>{clearTimeout(i),n&&clearInterval(n)}}}constructor(e){this.option=e,this.flick=!1}}class B{canUse(){return!!window.AudioContext||!!window.webkitAudioContext||(alert("소리 기능을 활용할 수 없는 브라우저입니다."),!1)}execute(e){let t=setTimeout(()=>{this.playBlinkSound()},"number"==typeof e.threshold&&e.threshold<1e3?1e3*e.threshold:e.threshold);return{stop:()=>{clearTimeout(t)}}}playBlinkSound(){if(!this.audioContext)return;let e=this.audioContext.createOscillator(),t=this.audioContext.createGain();e.type="sine",e.frequency.setValueAtTime(400,this.audioContext.currentTime),e.frequency.exponentialRampToValueAtTime(600,this.audioContext.currentTime+.1),t.gain.setValueAtTime(0,this.audioContext.currentTime),t.gain.linearRampToValueAtTime(.3,this.audioContext.currentTime+.05),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.3),e.connect(t),t.connect(this.audioContext.destination),e.start(this.audioContext.currentTime),e.stop(this.audioContext.currentTime+.3),setTimeout(()=>{if(!this.audioContext)return;let e=this.audioContext.createOscillator(),t=this.audioContext.createGain();e.type="sine",e.frequency.setValueAtTime(600,this.audioContext.currentTime),e.frequency.exponentialRampToValueAtTime(300,this.audioContext.currentTime+.08),t.gain.setValueAtTime(0,this.audioContext.currentTime),t.gain.linearRampToValueAtTime(.2,this.audioContext.currentTime+.04),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.25),e.connect(t),t.connect(this.audioContext.destination),e.start(this.audioContext.currentTime),e.stop(this.audioContext.currentTime+.25)},150)}constructor(e){this.options=e,this.audioContext=null;{let e=window.AudioContext||window.webkitAudioContext;e?this.audioContext=new e:this.audioContext=null}}}class C{create(e,t){let s=this.registry[e];if(!s)throw Error("Unknown shape");return new s(t)}constructor(){this.registry={PIP:j,Sound:B}}}let N=new Map;N.set(w.WarnFactory,new C);let E={get:e=>N.get(e)};class W{monitorStart(){new f(this.resolve).execute({type:"blink"})}monitorStop(){new b(this.resolve).execute({type:"blink"})}addWarnTool(e,t){let s=E.get(w.WarnFactory).create(e,t);new k(this.resolve).execute({type:"blink",toolType:e,warn:s})}deleteWarnTool(e){new T(this.resolve).execute({type:"blink",toolType:e})}setThreshold(e){new y(this.resolve).execute({type:"blink",threshold:e})}constructor(e){this.resolve=e}}class M{canUse(){return"undefined"!=typeof Worker&&!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}getCurrentValue(){return 0}async listen(e,t){this.listeners.set(e,t),this.isWorkerMode||await this.startWorkerMode()}async off(e){this.listeners.delete(e),0===this.listeners.size&&this.destructor()}async startWorkerMode(){if(this.isWorkerMode)return void console.warn("워커 모드가 이미 활성화되어 있습니다.");try{this.startVideoStream(),this.worker=await this.createWorker(),this.isWorkerMode=!0}catch(e){throw this.destructor(),e}}startVideoStream(){navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{this.videoElement.srcObject=e,this.videoElement.play().then(()=>{}).catch(e=>{console.warn("비디오 재생 실패:",e)})})}async createWorker(){try{let e=new Worker(s.tu(new URL(s.p+s.u(381),s.b)),{type:void 0});return e.onmessage=e=>this.handleWorkerMessage(e),e.onerror=e=>{console.error("워커 에러:",e)},e.postMessage({type:"initialize",data:{modelPath:"/face_landmarker.task"}}),e}catch(e){throw console.error("워커 생성 실패:",e),e}}handleWorkerMessage(e){let{type:t,data:s}=e.data;switch(t){case"requestVideoFrame":this.sendingVideoFrame();break;case"eyeStatus":this.isBlink(s.status)&&this.notifyListeners("blink",this.lastBlinkTime);break;case"error":console.error("워커 오류:",s.message)}}sendingVideoFrame(){if(this.worker&&(this.canvas||this.initCanvas(),this.updateCanvasSize(),this.canvas&&this.ctx)){this.ctx.drawImage(this.videoElement,0,0);let e=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);this.worker.postMessage({type:"getEyeStatus",data:{videoData:e,timestamp:performance.now()}})}}initCanvas(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}updateCanvasSize(){this.canvas&&this.videoElement.videoWidth>0&&(this.canvas.width=this.videoElement.videoWidth,this.canvas.height=this.videoElement.videoHeight)}isBlink(e){let t=e>this.blinkLimitScore?"close":"open";if("open"===this.eyeStatus&&"close"===t)this.eyeStatus="close";else if("close"===this.eyeStatus&&"open"===t)return this.eyeStatus="open",this.lastBlinkTime=performance.now(),!0;return!1}destructor(){if(null!==this.animationFrameId&&(window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.videoElement){this.videoElement.pause();let e=this.videoElement.srcObject;e&&e.getTracks().forEach(e=>e.stop()),this.videoElement.srcObject=null}this.videoElement&&(this.videoElement.pause(),this.videoElement.srcObject=null),this.worker&&(this.worker.terminate(),this.worker=null),this.canvas&&(this.canvas.width=0,this.canvas.height=0,this.canvas=null,this.ctx=null),this.isWorkerMode=!1}notifyListeners(e,t){let s=this.listeners.get(e);s&&s(t)}constructor(e){this.videoElement=e,this.animationFrameId=null,this.listeners=new Map,this.worker=null,this.isWorkerMode=!1,this.canvas=null,this.ctx=null,this.eyeStatus="open",this.blinkLimitScore=.4,this.lastBlinkTime=0}}class S{present(e){var t,s,n;let i={isRunning:e.status?"ACTIVE"===e.status:this.prevVM.isRunning,lastBlinkAt:null!=(t=e.lastBlinkAt)?t:this.prevVM.lastBlinkAt,warningThreshold:null!=(s=e.threshold)?s:this.prevVM.warningThreshold,soundOn:e.warnTools?e.warnTools.includes("Sound"):this.prevVM.soundOn,pipOn:e.warnTools?e.warnTools.includes("PIP"):this.prevVM.pipOn,pipFlick:null!=(n=e.pipFlick)?n:this.prevVM.pipFlick};this.prevVM=i,this.onPresent(i)}constructor(e){this.onPresent=e,this.prevVM={isRunning:!1,lastBlinkAt:new Date,warningThreshold:5,soundOn:!1,pipOn:!1,pipFlick:!1}}}function D(){var e,t,s,u,m,g,f,b,k,y;let[T,j]=(0,i.useState)(null),B=(0,i.useRef)(null),[C,N]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(!B.current)return;let e=function(e){var t,s,n,i,r,l,o,a,c,d,h,u,m,p,g,f,b,k,y;let T=new Map,j=[],B=e=>{let t=T.get(e);if(!t)throw Error("DI not found: ".concat(String(e)));if("function"==typeof t){let s=t();return T.set(e,s),s}return t},C={get:B},N=null!=(l=e.overrides)?l:{},E={presenter:()=>new S(e.setVM),sensor:()=>new M(e.videoEl),warn:()=>new v,warnTools:()=>new v,controller:e=>new W(e)},D=null!=(a=null!=(o=N.presenter)?o:null==(t=E.presenter)?void 0:t.call(E))?a:new S(e.setVM);T.set(w.Blink.Presenter,D);let P=null!=(d=null!=(c=N.sensor)?c:null==(s=E.sensor)?void 0:s.call(E))?d:new M(e.videoEl);T.set(w.Blink.Sensor,P);let A=null!=(h=N.repo)?h:new x;T.set(w.Blink.DB,A);let F=null!=(p=null!=(m=null!=(u=N.warn)?u:T.get(w.Blink.WarnTools))?m:null==(n=E.warn)?void 0:n.call(E))?p:new v;T.set(w.Blink.Warn,F);let V=null!=(b=null!=(f=null!=(g=N.warnTools)?g:T.get(w.Blink.Warn))?f:null==(i=E.warnTools)?void 0:i.call(E))?b:new v;T.set(w.Blink.WarnTools,V);let I=null!=(y=null!=(k=N.controller)?k:null==(r=E.controller)?void 0:r.call(E,C))?y:new W(C);for(let e of(T.set(w.Blink.Controller,I),T.values()))"function"==typeof(null==e?void 0:e.dispose)&&j.push(e);return{get:B,dispose(){for(let e=j.length-1;e>=0;e--)try{j[e].dispose()}catch(e){}T.clear()}}}({videoEl:B.current,setVM:j}),t=e.get(w.Blink.Controller);return N(t),()=>{t.monitorStop(),e.dispose()}},[]),(0,n.jsxs)("div",{className:"w-full max-w-md bg-white rounded-3xl shadow-2xl overflow-hidden",children:[(0,n.jsxs)("div",{className:"p-6 space-y-4",children:[(0,n.jsx)(a,{videoRef:B,isRunning:null!=(e=null==T?void 0:T.isRunning)&&e}),(0,n.jsx)(r,{lastBlinkAt:null!=(t=null==T?void 0:T.lastBlinkAt)?t:new Date,isRunning:null!=(s=null==T?void 0:T.isRunning)&&s}),(0,n.jsx)(d,{warningThreshold:null!=(u=null==T?void 0:T.warningThreshold)?u:5,onUpdateThreshold:e=>null==C?void 0:C.setThreshold(e)}),(0,n.jsx)(c,{isWarningEnabled:null!=(m=null==T?void 0:T.soundOn)&&m,onToggleWarning:()=>(null==T?void 0:T.soundOn)?null==C?void 0:C.deleteWarnTool("Sound"):null==C?void 0:C.addWarnTool("Sound",{volumn:50})}),(0,n.jsx)(h,{isWarningEnabled:null!=(g=null==T?void 0:T.pipOn)&&g,onToggleWarning:()=>(null==T?void 0:T.pipOn)?null==C?void 0:C.deleteWarnTool("PIP"):null==C?void 0:C.addWarnTool("PIP",{})}),(0,n.jsx)(l,{isRunning:null!=(f=null==T?void 0:T.isRunning)&&f})]}),(null==T?void 0:T.pipOn)&&(0,n.jsx)(p,{isRunning:null!=(b=null==T?void 0:T.isRunning)&&b,pipFlick:null!=(k=null==T?void 0:T.pipFlick)&&k}),(0,n.jsx)("div",{className:"px-6 pb-6",children:(0,n.jsx)(o,{isRunning:null!=(y=null==T?void 0:T.isRunning)&&y,onStart:()=>{C?C.monitorStart():alert("error")},onStop:()=>{C&&C.monitorStop()}})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[789,20,358],()=>t(309)),_N_E=e.O()}]);